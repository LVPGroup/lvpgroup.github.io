<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0249)http://127.0.0.1:50198/c3097003-0149-437b-b27b-41d4929a4424/preview?D%3A%5COneDrive+-+stu.xjtu.edu.cn%5C%E7%A7%91%E7%A0%94%5CPP%E6%A8%A1%E5%9E%8B%E9%A1%B9%E7%9B%AE%5CPP%E8%AE%BA%E6%96%87%5CPP_SecurityModel%28for+the+paper%29%5CSFRs%5CPP_HCL_data.thy -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style>/* Isabelle fonts */

@font-face {
  font-family: 'Isabelle DejaVu Sans';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSans.ttf') format('truetype');
}

@font-face {
  font-family: 'Isabelle DejaVu Sans';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSans-Bold.ttf') format('truetype');
  font-weight: bold;
}

@font-face {
  font-family: 'Isabelle DejaVu Sans';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSans-Oblique.ttf') format('truetype');
  font-style: italic;
}

@font-face {
  font-family: 'Isabelle DejaVu Sans';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSans-BoldOblique.ttf') format('truetype');
  font-weight: bold;
  font-style: italic;
}

@font-face {
  font-family: 'Isabelle DejaVu Sans Mono';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSansMono.ttf') format('truetype');
}

@font-face {
  font-family: 'Isabelle DejaVu Sans Mono';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSansMono-Bold.ttf') format('truetype');
  font-weight: bold;
}

@font-face {
  font-family: 'Isabelle DejaVu Sans Mono';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSansMono-Oblique.ttf') format('truetype');
  font-style: italic;
}

@font-face {
  font-family: 'Isabelle DejaVu Sans Mono';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSansMono-BoldOblique.ttf') format('truetype');
  font-weight: bold;
  font-style: italic;
}

@font-face {
  font-family: 'Isabelle DejaVu Serif';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSerif.ttf') format('truetype');
}

@font-face {
  font-family: 'Isabelle DejaVu Serif';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSerif-Bold.ttf') format('truetype');
  font-weight: bold;
}

@font-face {
  font-family: 'Isabelle DejaVu Serif';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSerif-Italic.ttf') format('truetype');
  font-style: italic;
}

@font-face {
  font-family: 'Isabelle DejaVu Serif';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSerif-BoldItalic.ttf') format('truetype');
  font-weight: bold;
  font-style: italic;
}

@font-face {
  font-family: 'Vacuous';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/Vacuous.ttf') format('truetype');
}


/* standard document markup */

dt {
  float: left;
  clear: left;
  padding-right: 0.5em;
  font-weight: bold;
}

body {
  color: #000000;
  background-color: #FFFFFF;
}

.head     { background-color: #FFFFFF; }
.source   {
  direction: ltr; unicode-bidi: bidi-override;
  background-color: #FFFFFF;
  padding: 10px;
  font-family: "Isabelle DejaVu Sans Mono", monospace;
}

.contents { background-color: #FFFFFF; padding: 10px; }
.sessions { background-color: #FFFFFF; padding: 10px; }
.document { white-space: normal; font-family: "Isabelle DejaVu Serif", serif; }

.name     { font-style: italic; }
.filename { font-family: "Isabelle DejaVu Sans Mono", monospace; }


/* basic syntax markup */

.hidden         { font-family: Vacuous; font-size: 1%; color: rgba(255,255,255,0); }
.control        { font-weight: bold; font-style: italic; }

.binding        { color: #336655; }
.tfree          { color: #A020F0; }
.tvar           { color: #A020F0; }
.free           { color: #0000FF; }
.skolem         { color: #D2691E; }
.bound          { color: #008000; }
.var            { color: #00009B; }
.numeral        { }
.literal        { font-weight: bold; }
.delimiter      { }
.inner_numeral  { color: #FF0000; }
.inner_quoted   { color: #FF00CC; }
.inner_cartouche { color: #CC6600; }
.comment1       { color: #CC0000; }
.comment2       { color: #FF8400; }
.comment3       { color: #6600CC; }
.dynamic        { color: #7BA428; }
.class_parameter_color { color: #D2691E; }

.bold           { font-weight: bold; }

.main           { color: #000000; }
.command        { font-weight: bold; }
.keyword        { font-weight: bold; }
.keyword1       { color: #006699; }
.keyword2       { color: #009966; }
.keyword3       { color: #0099FF; }
.quasi_keyword  { color: #9966FF; }
.operator       { color: #323232; }
.string         { color: #FF00CC; }
.alt_string     { color: #CC00CC; }
.verbatim       { color: #6600CC; }
.cartouche      { color: #CC6600; }
.comment        { color: #CC0000; }
.improper       { color: #FF5050; }
.antiquote      { color: #6600CC; }
.raw_text       { color: #6600CC; }
.plain_text     { color: #CC6600; }
.bad            { background-color: #FF6A6A; }
.quoted         { background-color: rgba(139,139,139,0.05); }
.antiquoted     { background-color: rgba(255,200,50,0.1); }


/* message background */

.writeln_message      { background-color: #F0F0F0; }
.information_message  { background-color: #DCEAF3; }
.tracing_message      { background-color: #F0F8FF; }
.warning_message      { background-color: #EEE8AA; }
.legacy_message       { background-color: #EEE8AA; }
.error_message        { background-color: #FFC1C1; }


/* message underline */

.writeln { border-bottom: 1px dotted #C0C0C0; }
.information { border-bottom: 1px dotted #C1DFEE; }
.warning { border-bottom: 1px dotted #FF8C00; }
.legacy { border-bottom: 1px dotted #FF8C00; }
.error { border-bottom: 1px dotted #B22222; }


/* tooltips */

.writeln { position: relative; display: inline-block; }
.information { position: relative; display: inline-block; }
.warning { position: relative; display: inline-block; }
.legacy { position: relative; display: inline-block; }
.error { position: relative; display: inline-block; }

.writeln:hover .tooltip { visibility: visible; }
.information:hover .tooltip { visibility: visible; }
.warning:hover .tooltip { visibility: visible; }
.legacy:hover .tooltip { visibility: visible; }
.error:hover .tooltip { visibility: visible; }

.tooltip {
  top: -0.5ex;
  left: 5em;
  visibility: hidden;
  width: 50em;
  border: 1px solid #808080;
  padding: 1px 1px;
  background-color: #FFFFE9;
  position: absolute;
  z-index: 1;
}

.tooltip pre { margin: 1px; white-space: pre-wrap; }
</style><title>Theory "PP_HCL_data"</title></head>
<body data-new-gr-c-s-check-loaded="14.1149.0" data-gr-ext-installed=""><pre class="source"><span class="comment1">(*This file describes data structures for high compositional layer of security functional requirements 
defined in GlobePlatFrom Protection Profile. 
Written by Zhejiang University, Hangzhou, China.*)</span>


<span class="keyword1"><span class="command">theory</span></span> PP_HCL_data
  <span class="keyword2"><span class="keyword">imports</span></span> Main 
    <span class="quoted">"PP_RSM"</span>
    <span class="quoted">"../SOs/PP_Objectives"</span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">section</span></span> <span class="quoted"><span class="document"><span class="plain_text">"General Framework"</span></span></span>

<span class="comment1">(*
Users stand for entities outside the TOE:
 Client Applications (CA), with security attribute "CA_identity" (CA identifier)
 Trusted Applications (TA), with security attribute "TA_identity" (TA identifier), "TA_properties".
*)</span>


<span class="keyword1"><span class="command">datatype</span></span> <span class="main">(</span><span class="tfree">'ta</span><span class="main">,</span><span class="tfree">'ca</span><span class="main">)</span> user <span class="main">=</span>ta <span class="tfree"><span class="quoted"><span class="tfree">'ta</span></span></span><span class="main">|</span>ca <span class="tfree"><span class="quoted"><span class="tfree">'ca</span></span></span>

<span class="comment1">(* 
Subjects stand for active entities inside the TOE:
 S.TA_INSTANCE: Any TA instance with security attribute "TA_identity" (TA identifier)
 S.TA_INSTANCE_SESSION: Any session within a given TA instance, with security attribute 
"client_identity" (CA identifier)
 S.API: The TEE Internal Core API, with security attributes "caller" (TA identifier)
 S.RESOURCE: Any software or hardware component which may be used alternatively by the TEE or 
the REE, with security attribute "state" (TEE/REE), e.g. cryptographic accelerator, random number 
generator, cache, registers. Note: When the state is REE, the TEE may access the resource. The 
communication buses are not considered as subjects (cf. FDP_ITT.1)
 S.RAM_UNIT: RAM addressable unit, with security attribute "rights: (TA identifier/REE) -&gt; 
(Read/Write/ReadWrite/NoAccess)". For instance, an addressable unit may be allocated or have its 
access rights changed upon TA instance creation or when sharing memory references between a client 
(CA, TA) and a TA. Notes: 1) A RAM_UNIT typically stands for a byte in the C language; 2) There is no 
RAM access restriction applicable to the TEE itself
 S.COMM_AGENT: Proxy between CAs in the REE and the TEE and its TAs.
*)</span>



<span class="keyword1"><span class="command">datatype</span></span> SUBJECT1 <span class="main">=</span> S_TA_INSTANCE<span class="main">|</span>S_TA_INSTANCE_SESSION<span class="main">|</span>S_API<span class="main">|</span>S_COMM_AGENT<span class="main">|</span>S_RESOURCE<span class="main">|</span>S_RAM_UNIT
<span class="keyword1"><span class="command">datatype</span></span> rights <span class="main">=</span> Read<span class="main">|</span>Write<span class="main">|</span>ReadWrite<span class="main">|</span>NoAccess


<span class="keyword1"><span class="command">datatype</span></span> RUNTIME_DATA<span class="main">=</span>RUMTIME_DATA_P<span class="main">|</span>RUNTIME_DATA_M

<span class="keyword1"><span class="command">record</span></span> <span class="tfree">'cid</span> S_API <span class="main">=</span> caller<span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'cid</span> option"</span></span>

<span class="keyword1"><span class="command">record</span></span> <span class="tfree">'cid</span> TA_INSTANCE_SESSION <span class="main">=</span> 
          client_identity <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'cid</span></span></span> 
          server_identity <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'cid</span></span></span>

<span class="keyword1"><span class="command">record</span></span> <span class="tfree">'cid</span> S_TA_INSTANCE <span class="main">=</span> TA_identity<span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'cid</span>"</span></span>

<span class="keyword1"><span class="command">record</span></span> <span class="tfree">'d</span> S_RESOURCE <span class="main">=</span> Rstate<span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'d</span>"</span></span><span class="comment1">(*REE or TEE*)</span>

<span class="keyword1"><span class="command">datatype</span></span> RWright <span class="main">=</span> Read<span class="main">|</span>Write<span class="main">|</span>ReadWrite<span class="main">|</span>NoAccess

<span class="keyword1"><span class="command">record</span></span> <span class="main">(</span><span class="tfree">'cid</span><span class="main">,</span><span class="tfree">'d</span><span class="main">)</span> S_RAM_UNIT <span class="main">=</span> 
                    TArights<span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'cid</span><span class="main">⇒</span>RWright"</span></span>
                    REErights<span class="main">::</span><span class="quoted"><span class="quoted">"RWright"</span></span>

<span class="keyword1"><span class="command">record</span></span> <span class="main">(</span><span class="tfree">'cid</span><span class="main">,</span><span class="tfree">'d</span><span class="main">)</span> S_RAM_UNIT2 <span class="main">=</span> 
                    TArights2<span class="main">::</span><span class="quoted"><span class="quoted">"RWright"</span></span>
                    REErights2<span class="main">::</span><span class="quoted"><span class="quoted">"RWright"</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ram_test</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'cid</span><span class="main">,</span><span class="tfree">'d</span><span class="main">)</span> S_RAM_UNIT2"</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">ram_test</span> <span class="main">≡</span> <span class="main">⦇</span>TArights2<span class="main">=</span>Read<span class="main">,</span>REErights2<span class="main">=</span>Read<span class="main">⦈</span>"</span></span>



<span class="keyword1"><span class="command">datatype</span></span> <span class="main">(</span><span class="tfree">'cid</span><span class="main">,</span><span class="tfree">'d</span><span class="main">)</span> SUBJECT <span class="main">=</span> api <span class="quoted"><span class="quoted">"<span class="tfree">'cid</span> S_API"</span></span>
                             <span class="main">|</span>inst <span class="quoted"><span class="quoted">"<span class="tfree">'cid</span> S_TA_INSTANCE"</span></span> 
                             <span class="main">|</span> instses <span class="quoted"><span class="quoted">"<span class="tfree">'cid</span> TA_INSTANCE_SESSION"</span></span>
                             <span class="main">|</span>res <span class="quoted"><span class="quoted">"<span class="tfree">'d</span> S_RESOURCE"</span></span>
                             <span class="main">|</span>ram <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="tfree">'cid</span><span class="main">,</span><span class="tfree">'d</span><span class="main">)</span> S_RAM_UNIT"</span></span>
                              <span class="main">|</span>S_COMM_AGENT




<span class="comment1">(*
Cryptographic objects are a special kind of TEE object:
 OB.TA_KEY (user data): (handle to a) user key (persistent or transient), with security attributes "usage", 
"owner" (TA identifier), "isExtractable" (True/False).*)</span>

<span class="keyword1"><span class="command">record</span></span> <span class="main">(</span><span class="tfree">'usage</span><span class="main">,</span><span class="tfree">'cid</span><span class="main">)</span> OB_TA_KEY <span class="main">=</span>
          usage<span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'usage</span>"</span></span>
          owner<span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'cid</span>"</span></span>
          is_Extractable<span class="main">::</span><span class="quoted">bool</span>


<span class="comment1">(*
Objects stand for passive entities inside the TOE:
 OB.TA_STORAGE (user data): Trusted Storage space of a TA, with security attributes "owner" (TA identifier), 
        "inExtMem" (True/False) and "TEE_identity" (TEE identifier).
 OB.SRT (TSF data): The TEE Storage Root of Trust, with security attribute "TEE_identity" (TEE identifier).
*)</span>


<span class="keyword1"><span class="command">datatype</span></span> <span class="main">(</span><span class="tfree">'cid</span><span class="main">)</span> OBJECT <span class="main">=</span> tas <span class="quoted"><span class="quoted">"<span class="tfree">'cid</span> OB_TA_STORAGE"</span></span><span class="main">|</span>
                          tak <span class="quoted"><span class="quoted">"<span class="tfree">'cid</span> OB_TA_KEY"</span></span><span class="main">|</span>
                          tsf <span class="quoted">OB_SRT</span>


<span class="keyword1"><span class="command">datatype</span></span> ATTR <span class="main">=</span> TA_identity1<span class="main">|</span>client_identity1<span class="main">|</span>caller1<span class="main">|</span>state1<span class="main">|</span>unknown
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">GetATTRBySUB</span><span class="main">::</span><span class="quoted"><span class="quoted">"SUBJECT1<span class="main">⇒</span>ATTR"</span></span> <span class="keyword2"><span class="keyword">where</span></span>
<span class="quoted"><span class="quoted">"<span class="free">GetATTRBySUB</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="main">≡</span> <span class="keyword1">case</span> <span class="free"><span class="bound"><span class="entity">a</span></span></span> <span class="keyword1">of</span> S_TA_INSTANCE <span class="main">⇒</span> TA_identity1
                          <span class="main">|</span>S_TA_INSTANCE_SESSION <span class="main">⇒</span> client_identity1
                          <span class="main">|</span>S_API <span class="main">⇒</span> caller1
                          <span class="main">|</span>S_RESOURCE <span class="main">⇒</span> state1
                          <span class="main">|</span><span class="main"><span class="bound">_</span></span> <span class="main">⇒</span> unknown"</span></span>

<span class="keyword2"><span class="keyword">end</span></span>
</pre>
<deepl-input-controller><template shadowrootmode="open"><link rel="stylesheet" href="chrome-extension://cofdbpoegempjloogbagkncekinflcnj/build/content.css"><div><div class="dl-input-translation-container svelte-ju4595"><div></div></div></div></template></deepl-input-controller></body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;full&quot;,&quot;isActive&quot;:true,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>