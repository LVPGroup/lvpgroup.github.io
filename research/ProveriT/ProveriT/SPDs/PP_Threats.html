<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0247)http://127.0.0.1:50198/c3097003-0149-437b-b27b-41d4929a4424/preview?D%3A%5COneDrive+-+stu.xjtu.edu.cn%5C%E7%A7%91%E7%A0%94%5CPP%E6%A8%A1%E5%9E%8B%E9%A1%B9%E7%9B%AE%5CPP%E8%AE%BA%E6%96%87%5CPP_SecurityModel%28for+the+paper%29%5CSPD%5CPP_Threats.thy -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style>/* Isabelle fonts */

@font-face {
  font-family: 'Isabelle DejaVu Sans';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSans.ttf') format('truetype');
}

@font-face {
  font-family: 'Isabelle DejaVu Sans';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSans-Bold.ttf') format('truetype');
  font-weight: bold;
}

@font-face {
  font-family: 'Isabelle DejaVu Sans';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSans-Oblique.ttf') format('truetype');
  font-style: italic;
}

@font-face {
  font-family: 'Isabelle DejaVu Sans';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSans-BoldOblique.ttf') format('truetype');
  font-weight: bold;
  font-style: italic;
}

@font-face {
  font-family: 'Isabelle DejaVu Sans Mono';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSansMono.ttf') format('truetype');
}

@font-face {
  font-family: 'Isabelle DejaVu Sans Mono';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSansMono-Bold.ttf') format('truetype');
  font-weight: bold;
}

@font-face {
  font-family: 'Isabelle DejaVu Sans Mono';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSansMono-Oblique.ttf') format('truetype');
  font-style: italic;
}

@font-face {
  font-family: 'Isabelle DejaVu Sans Mono';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSansMono-BoldOblique.ttf') format('truetype');
  font-weight: bold;
  font-style: italic;
}

@font-face {
  font-family: 'Isabelle DejaVu Serif';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSerif.ttf') format('truetype');
}

@font-face {
  font-family: 'Isabelle DejaVu Serif';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSerif-Bold.ttf') format('truetype');
  font-weight: bold;
}

@font-face {
  font-family: 'Isabelle DejaVu Serif';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSerif-Italic.ttf') format('truetype');
  font-style: italic;
}

@font-face {
  font-family: 'Isabelle DejaVu Serif';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/IsabelleDejaVuSerif-BoldItalic.ttf') format('truetype');
  font-weight: bold;
  font-style: italic;
}

@font-face {
  font-family: 'Vacuous';
  src: url('/c3097003-0149-437b-b27b-41d4929a4424/fonts/Vacuous.ttf') format('truetype');
}


/* standard document markup */

dt {
  float: left;
  clear: left;
  padding-right: 0.5em;
  font-weight: bold;
}

body {
  color: #000000;
  background-color: #FFFFFF;
}

.head     { background-color: #FFFFFF; }
.source   {
  direction: ltr; unicode-bidi: bidi-override;
  background-color: #FFFFFF;
  padding: 10px;
  font-family: "Isabelle DejaVu Sans Mono", monospace;
}

.contents { background-color: #FFFFFF; padding: 10px; }
.sessions { background-color: #FFFFFF; padding: 10px; }
.document { white-space: normal; font-family: "Isabelle DejaVu Serif", serif; }

.name     { font-style: italic; }
.filename { font-family: "Isabelle DejaVu Sans Mono", monospace; }


/* basic syntax markup */

.hidden         { font-family: Vacuous; font-size: 1%; color: rgba(255,255,255,0); }
.control        { font-weight: bold; font-style: italic; }

.binding        { color: #336655; }
.tfree          { color: #A020F0; }
.tvar           { color: #A020F0; }
.free           { color: #0000FF; }
.skolem         { color: #D2691E; }
.bound          { color: #008000; }
.var            { color: #00009B; }
.numeral        { }
.literal        { font-weight: bold; }
.delimiter      { }
.inner_numeral  { color: #FF0000; }
.inner_quoted   { color: #FF00CC; }
.inner_cartouche { color: #CC6600; }
.comment1       { color: #CC0000; }
.comment2       { color: #FF8400; }
.comment3       { color: #6600CC; }
.dynamic        { color: #7BA428; }
.class_parameter_color { color: #D2691E; }

.bold           { font-weight: bold; }

.main           { color: #000000; }
.command        { font-weight: bold; }
.keyword        { font-weight: bold; }
.keyword1       { color: #006699; }
.keyword2       { color: #009966; }
.keyword3       { color: #0099FF; }
.quasi_keyword  { color: #9966FF; }
.operator       { color: #323232; }
.string         { color: #FF00CC; }
.alt_string     { color: #CC00CC; }
.verbatim       { color: #6600CC; }
.cartouche      { color: #CC6600; }
.comment        { color: #CC0000; }
.improper       { color: #FF5050; }
.antiquote      { color: #6600CC; }
.raw_text       { color: #6600CC; }
.plain_text     { color: #CC6600; }
.bad            { background-color: #FF6A6A; }
.quoted         { background-color: rgba(139,139,139,0.05); }
.antiquoted     { background-color: rgba(255,200,50,0.1); }


/* message background */

.writeln_message      { background-color: #F0F0F0; }
.information_message  { background-color: #DCEAF3; }
.tracing_message      { background-color: #F0F8FF; }
.warning_message      { background-color: #EEE8AA; }
.legacy_message       { background-color: #EEE8AA; }
.error_message        { background-color: #FFC1C1; }


/* message underline */

.writeln { border-bottom: 1px dotted #C0C0C0; }
.information { border-bottom: 1px dotted #C1DFEE; }
.warning { border-bottom: 1px dotted #FF8C00; }
.legacy { border-bottom: 1px dotted #FF8C00; }
.error { border-bottom: 1px dotted #B22222; }


/* tooltips */

.writeln { position: relative; display: inline-block; }
.information { position: relative; display: inline-block; }
.warning { position: relative; display: inline-block; }
.legacy { position: relative; display: inline-block; }
.error { position: relative; display: inline-block; }

.writeln:hover .tooltip { visibility: visible; }
.information:hover .tooltip { visibility: visible; }
.warning:hover .tooltip { visibility: visible; }
.legacy:hover .tooltip { visibility: visible; }
.error:hover .tooltip { visibility: visible; }

.tooltip {
  top: -0.5ex;
  left: 5em;
  visibility: hidden;
  width: 50em;
  border: 1px solid #808080;
  padding: 1px 1px;
  background-color: #FFFFE9;
  position: absolute;
  z-index: 1;
}

.tooltip pre { margin: 1px; white-space: pre-wrap; }
</style><title>Theory "PP_Threats"</title></head>
<body data-new-gr-c-s-check-loaded="14.1149.0" data-gr-ext-installed=""><pre class="source"><span class="comment1">(*This file describes security threats defined in GlobePlatFrom Protection Profile.
Written by Zhejiang University, Hangzhou, China.*)</span>

<span class="keyword1"><span class="command">theory</span></span> PP_Threats
  <span class="keyword2"><span class="keyword">imports</span></span> Main
          PP_TSM
<span class="keyword2"><span class="keyword">begin</span></span>


<span class="comment1">(*
T.ABUSE_FUNCT
An attacker accesses TEE functionality outside of their expected availability range, thus violating 
irreversible phases of the TEE life cycle or state machine.
An attacker manages to instantiate an illegal TEE or to start up the TEE in an insecure state or to enter an 
insecure state, allowing the attacker to obtain sensitive data or compromise the TSF (bypass, deactivate,
or change security services).
Assets threatened directly: TEE initialisation code and data (integrity), TEE runtime data (confidentiality, 
integrity), RNG (confidentiality, integrity), TA code (authenticity, consistency).
Assets threatened indirectly: TA data and keys (confidentiality, authenticity, consistency) including instance 
time.
Application Note:
Attack paths may consist in, for instance, using commands in unexpected contexts or with unexpected 
parameters, impersonating authorized entities, or exploiting badly implemented reset functionality that 
provides undue privileges.
In particular, a fake application running in the Regular OS which masquerades as a security application 
running in the TEE can grab PINs and passwords and run the real security application on behalf of the user. 
However, such a threat cannot be countered by the TEE alone and must be taken into account in the design 
of the service, for instance by using an applicative authenticated communication channel between the client 
and the TA
*)</span>


<span class="keyword1"><span class="command">locale</span></span> T_ABUSE_FUNCT <span class="main">=</span> TState <span class="main">+</span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">valid_action</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'s</span><span class="main">⇒</span><span class="tfree">'a</span><span class="main">⇒</span><span class="tfree">'cid</span><span class="main">⇒</span>bool"</span></span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">valid_access</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'s</span><span class="main">⇒</span><span class="tfree">'a</span><span class="main">⇒</span><span class="tfree">'cid</span><span class="main">⇒</span>bool"</span></span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">initialize</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'sysconf</span><span class="main">⇒</span><span class="tfree">'s</span>"</span></span>
    <span class="comment1">(*instantiate an illegal TEE or to start up the TEE in an insecure state*)</span>
    <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">s0</span> <span class="main">=</span> <span class="free">initialize</span> <span class="free">sc</span><span class="main">∧</span><span class="free">secure_state</span> <span class="free">s0</span>"</span></span>
    <span class="comment1">(*accesses TEE functionality outside of their expected availability range*)</span>
    <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">(</span><span class="main">¬</span> <span class="free">valid_action</span> <span class="free">s</span> <span class="free">a</span> <span class="free">cid</span> <span class="main">∨</span> <span class="main">¬</span> <span class="free">valid_access</span> <span class="free">s</span> <span class="free">a</span> <span class="free">cid</span> <span class="main">)</span><span class="main">∧</span><span class="free">s'</span><span class="main">=</span><span class="free">Trans</span> <span class="free">s</span> <span class="free">a</span><span class="main">⟶</span> <span class="free">secure_state</span> <span class="free">s'</span>"</span></span>


<span class="comment1">(*
T.CLONE
An attacker manages to copy TEE related data from one device to a second device and makes this device 
accept them as genuine data.
Assets threatened directly: All data and keys (authenticity, device-binding), TEE identification data 
(authenticity, integrity).
*)</span>

<span class="keyword1"><span class="command">locale</span></span> T_CLONE <span class="main">=</span> 
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">get_related_data</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'s</span><span class="main">⇒</span><span class="tfree">'set</span>"</span></span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">bind_check</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'set</span><span class="main">⇒</span><span class="tfree">'SoC</span><span class="main">⇒</span>bool"</span></span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">getSoc</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'s</span><span class="main">⇒</span><span class="tfree">'SoC</span>"</span></span>
    <span class="comment1">(*makes this device accept them as genuine data.*)</span>
    <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">s</span><span class="main">.</span> <span class="free">bind_check</span> <span class="main">(</span><span class="free">get_related_data</span> <span class="bound">s</span><span class="main">)</span> <span class="main">(</span><span class="free">getSoc</span> <span class="bound">s</span><span class="main">)</span>"</span></span>


<span class="comment1">(*
T.FLASH_DUMP
An attacker partially or totally recovers the content of the external Flash in cleartext, thus disclosing 
sensitive TA or TEE data and potentially allowing the attacker to mount other attacks.
Assets threatened directly (confidentiality, authenticity, consistency): TA data and keys, TEE persistent 
data.
Application Note:
An attack path consists for instance in performing a (partial) memory dump through the REE, purely via 
software or with a USB connection.
During identification, another example consists in unsoldering the Flash memory and dumping its content, 
e.g. revealing a secret key that provides privileged access to many devices of the same model.
*)</span>

<span class="keyword1"><span class="command">locale</span></span> T_FLUSH_DUMP <span class="main">=</span> TState <span class="main">+</span>

    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">encrypted</span> <span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'ts</span><span class="main">⇒</span><span class="tfree">'SoC</span><span class="main">⇒</span>bool"</span></span>
   <span class="comment1">(* fixes getTS::"'s⇒'ts"*)</span>
    <span class="comment1">(*recovers the content of the external Flash in cleartext*)</span>
    <span class="comment1">(*means the information stored in TS must be encrypted all the time*)</span>
    <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">s</span><span class="main">.</span> <span class="free">encrypted</span> <span class="main">(</span><span class="free">getTS</span> <span class="bound">s</span><span class="main">)</span> <span class="main">(</span><span class="free">getSoc</span> <span class="bound">s</span><span class="main">)</span>"</span></span>



<span class="comment1">(*
T.IMPERSONATION
An attacker impersonates a Trusted Application to gain unauthorized access to the services and data of 
another Trusted Application.
Assets threatened directly (confidentiality, integrity): TEE runtime data, RNG.
Assets threatened indirectly: All data and keys (confidentiality, authenticity, consistency).
*)</span>


<span class="keyword1"><span class="command">locale</span></span> T_IMPERSONATION <span class="main">=</span> 
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">valid_access</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'s</span><span class="main">⇒</span><span class="tfree">'a</span><span class="main">⇒</span><span class="tfree">'ta</span><span class="main">⇒</span>bool"</span></span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">success_check</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'s</span><span class="main">⇒</span>bool"</span></span>
    <span class="comment1">(*impersonates a Trusted Application to gain unauthorized access to the services and data of another Trusted Application*)</span>
    <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">s</span> <span class="bound">a</span> <span class="bound">ta</span><span class="main">.</span> <span class="main">¬</span><span class="main">(</span><span class="free">valid_access</span> <span class="bound">s</span> <span class="bound">a</span> <span class="bound">ta</span><span class="main">)</span> <span class="main">⟶</span> <span class="free">success_check</span> <span class="bound">s</span>"</span></span>
    <span class="comment1">(*if not valid, then not succeed.*)</span>


<span class="comment1">(*
T.ROGUE_CODE_EXECUTION
An attacker imports malicious code into the TEE to disclose or modify sensitive data.
Assets threatened directly (confidentiality, integrity): TEE runtime data, RNG.
Assets threatened indirectly (confidentiality, authenticity, consistency): All assets.
Application Note:
Importation of code within the REE is out of control of the TEE
*)</span>

<span class="keyword1"><span class="command">locale</span></span> T_ROGUE_CODE_EXECUTION <span class="main">=</span> 
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">insert</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'phase</span><span class="main">⇒</span><span class="tfree">'code</span><span class="main">⇒</span>bool"</span></span>
    <span class="comment1">(*imports malicious code into the TEE*)</span>
    <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">phase</span><span class="main">.</span> <span class="main">¬</span> <span class="main">(</span><span class="free">insert</span> <span class="bound">phase</span> <span class="free">code</span><span class="main">)</span>"</span></span>


<span class="comment1">(*
T.PERTURBATION
An attacker modifies the behaviour of the TEE or the behaviour of a TA in order to disclose or modify 
sensitive data or to force the TEE or the TA to execute unauthorized services.
Assets threatened directly: TEE initialisation code and data (integrity), TEE storage root of trust 
(confidentiality, integrity), TEE runtime data (confidentiality, integrity), RNG (confidentiality, integrity).
Assets threatened indirectly: All data and keys (confidentiality, authenticity, consistency) including TA 
instance time.
Application Note:
Unauthorized use of commands (one or many incorrect commands, undefined commands, hidden 
commands, invalid command sequence) or buffer overflow attacks (overwriting buffer content to modify 
execution contexts or gaining system privileges) are examples of attack paths. The TEE can also be 
attacked through REE or TA “programmer errors” that, for example, exploit multi-threading, context/session 
management, or closed sessions; or by triggering system resets during execution of commands by the 
TEE.

*)</span>

<span class="keyword1"><span class="command">locale</span></span> T_PERTURBATION <span class="main">=</span> 
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">modify_data</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'s</span><span class="main">⇒</span><span class="tfree">'s</span>"</span></span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">secure_state</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'s</span><span class="main">⇒</span>bool"</span></span>
    <span class="comment1">(*modifies the behaviour of the TEE or the behaviour of a TA*)</span>
    <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">s'</span><span class="main">=</span> <span class="free">modify_data</span> <span class="free">s</span><span class="main">⟶</span><span class="main">¬</span><span class="free">secure_state</span> <span class="free">s'</span>"</span></span>


<span class="comment1">(*
T.RAM
An attacker partially or totally recovers RAM content, thus disclosing runtime data and potentially allowing 
the attacker to interfere with the TEE initialisation code and data.
Assets threatened directly: TEE initialisation code and data (integrity), TEE storage root of trust 
(confidentiality, integrity), TEE runtime data (confidentiality, integrity), RNG (confidentiality, integrity).
Assets threatened indirectly: All data and keys (confidentiality, authenticity, consistency).
Application Note:
When the REE and the TEE share some memory, an attack path consists in a (partial) memory dump 
(read/write) by the REE.
During the identification phase, another example of an attack path is to snoop on a memory bus, revealing 
code that is only decrypted at runtime, and finding a flaw in that code that can be exploited.
*)</span>

<span class="keyword1"><span class="command">locale</span></span> T_RAM <span class="main">=</span> 
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">Read</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'mm</span><span class="main">⇒</span><span class="tfree">'d</span><span class="main">⇒</span>bool"</span></span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">Write</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'mm</span><span class="main">⇒</span><span class="tfree">'d</span><span class="main">⇒</span>bool"</span></span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">getMem</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'s</span><span class="main">⇒</span><span class="tfree">'d</span><span class="main">⇒</span><span class="tfree">'mm</span>"</span></span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">TEE</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'d</span></span></span> <span class="comment1">(* the TEE domain *)</span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">REE</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'d</span></span></span> <span class="comment1">(* the REE domain *)</span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">TA_domain</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'s</span><span class="main">⇒</span> <span class="tfree">'ta</span> <span class="main">⇒</span> <span class="tfree">'d</span>"</span></span>  <span class="comment1">(* domain id of TAs *)</span>
    <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">TEE</span> <span class="main">≠</span> <span class="free">REE</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span>   <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">ta</span> <span class="bound">s</span><span class="main">.</span> <span class="free">TA_domain</span> <span class="bound">s</span> <span class="bound">ta</span> <span class="main">≠</span> <span class="free">TEE</span> <span class="main">∧</span> <span class="free">TA_domain</span> <span class="bound">s</span> <span class="bound">ta</span> <span class="main">≠</span> <span class="free">REE</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span>   <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">s</span><span class="main">.</span> inj <span class="main">(</span><span class="free">TA_domain</span> <span class="bound">s</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span>   <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">d</span> <span class="bound">s</span><span class="main">.</span> <span class="bound">d</span> <span class="main">=</span> <span class="free">TEE</span> <span class="main">∨</span> <span class="bound">d</span> <span class="main">=</span> <span class="free">REE</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span><span class="bound">ta</span><span class="main">.</span> <span class="free">TA_domain</span> <span class="bound">s</span> <span class="bound">ta</span> <span class="main">=</span> <span class="bound">d</span><span class="main">)</span>"</span></span> 
    <span class="comment1">(*partially or totally recovers RAM content, thus disclosing runtime data*)</span>
    <span class="keyword2"><span class="keyword">assumes</span></span> Readctl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="free">Read</span> <span class="main">(</span><span class="free">getMem</span> <span class="free">s</span> <span class="free">TEE</span><span class="main">)</span> <span class="free">REE</span> <span class="main">∧</span><span class="main">¬</span><span class="free">Read</span> <span class="main">(</span><span class="free">getMem</span> <span class="free">s</span> <span class="main">(</span><span class="free">TA_domain</span> <span class="free">s</span> <span class="free">ta</span><span class="main">)</span><span class="main">)</span> <span class="free">REE</span>"</span></span>
    <span class="keyword2"><span class="keyword">assumes</span></span> Writectl<span class="main">:</span><span class="quoted"><span class="quoted">"<span class="main">¬</span><span class="free">Write</span> <span class="main">(</span><span class="free">getMem</span> <span class="free">s</span> <span class="free">TEE</span><span class="main">)</span> <span class="free">REE</span> <span class="main">∧</span><span class="main">¬</span><span class="free">Write</span> <span class="main">(</span><span class="free">getMem</span> <span class="free">s</span> <span class="main">(</span><span class="free">TA_domain</span> <span class="free">s</span> <span class="free">ta</span><span class="main">)</span><span class="main">)</span> <span class="free">REE</span> "</span></span>
  


<span class="comment1">(*
T.RNG
An attacker obtains information in an unauthorized manner about random numbers generated by the TEE. 
This may occur, for instance, because the generated random numbers have insufficient entropy, or because 
the attacker forces the output of a partially or totally predefined value.
Loss of unpredictability (the main property of random numbers) is a problem in case they are used to 
generate cryptographic keys. Malfunctions or premature ageing may also allow getting information about 
random numbers.
Assets threatened directly (confidentiality, integrity): RNG and secrets derived from random numbers.
*)</span>

<span class="keyword1"><span class="command">locale</span></span> T_RNG <span class="main">=</span> 
    <span class="comment1">(*obtains information in an unauthorized manner about random numbers*)</span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">unpredict</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'rng</span><span class="main">⇒</span>bool"</span></span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">rng_gen</span><span class="main">::</span><span class="quoted"><span class="quoted">"nat<span class="main">⇒</span><span class="tfree">'rng</span>"</span></span>
    <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">unpredict</span> <span class="main">(</span><span class="free">rng_gen</span> <span class="free">x</span><span class="main">)</span>"</span></span>



<span class="comment1">(*
T.SPY
An attacker discloses confidential data or keys by means of runtime attacks or by unauthorized access to 
storage locations.
Assets threatened directly (confidentiality): All data and keys, TEE storage root of trust
Application Note:
Exploitation of side-channels by a CA or a TA (e.g. timing, power consumption), retrieving residual sensitive 
data (e.g. improperly cleared memory) or use of undocumented or invalid command codes are examples 
of attack paths. The data may be used to exploit the device it was obtained on, or another device (e.g. a 
shared secret key).
During the identification phase, the attacker may for instance probe external buses
*)</span>

<span class="keyword1"><span class="command">locale</span></span> T_SPY <span class="main">=</span> 
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">tsSecure</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span><span class="main">⇒</span><span class="tfree">'ts</span><span class="main">⇒</span><span class="tfree">'apicaller</span><span class="main">⇒</span>bool"</span></span>  
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">Store_op</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span>"</span></span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">Read_op</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'a</span>"</span></span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">gettsOwner</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'ts</span><span class="main">⇒</span><span class="tfree">'apicaller</span>"</span></span>
    <span class="comment1">(*discloses confidential data by unauthorized access to storage locations.*)</span>
    <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">call</span><span class="main">≠</span><span class="main">(</span><span class="free">gettsOwner</span> <span class="free">ts</span><span class="main">)</span><span class="main">⟶</span><span class="main">¬</span><span class="main">(</span><span class="free">tsSecure</span> <span class="free">Read_op</span> <span class="free">ts</span> <span class="free">call</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">getMem</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'s</span><span class="main">⇒</span><span class="tfree">'d</span><span class="main">⇒</span><span class="tfree">'mm</span>"</span></span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">readMem</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'mm</span><span class="main">⇒</span><span class="tfree">'d</span><span class="main">⇒</span><span class="tfree">'mc</span> option"</span></span><span class="comment1">(*memory content*)</span>
    <span class="comment1">(*fixes getMemOwner::"'mm⇒'d"*)</span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">TEE</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'d</span></span></span> <span class="comment1">(* the TEE domain *)</span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">REE</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'d</span></span></span> <span class="comment1">(* the REE domain *)</span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">TA_domain</span> <span class="main">::</span> <span class="quoted"><span class="quoted">"<span class="tfree">'s</span><span class="main">⇒</span> <span class="tfree">'ta</span> <span class="main">⇒</span> <span class="tfree">'d</span>"</span></span>  <span class="comment1">(* domain id of TAs *)</span>
    <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">TEE</span> <span class="main">≠</span> <span class="free">REE</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span>   <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">ta</span> <span class="bound">s</span><span class="main">.</span> <span class="free">TA_domain</span> <span class="bound">s</span> <span class="bound">ta</span> <span class="main">≠</span> <span class="free">TEE</span> <span class="main">∧</span> <span class="free">TA_domain</span> <span class="bound">s</span> <span class="bound">ta</span> <span class="main">≠</span> <span class="free">REE</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span>   <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">s</span><span class="main">.</span> inj <span class="main">(</span><span class="free">TA_domain</span> <span class="bound">s</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span>   <span class="quoted"><span class="quoted">"<span class="main">∀</span><span class="bound">d</span> <span class="bound">s</span><span class="main">.</span> <span class="bound">d</span> <span class="main">=</span> <span class="free">TEE</span> <span class="main">∨</span> <span class="bound">d</span> <span class="main">=</span> <span class="free">REE</span> <span class="main">∨</span> <span class="main">(</span><span class="main">∃</span><span class="bound">ta</span><span class="main">.</span> <span class="free">TA_domain</span> <span class="bound">s</span> <span class="bound">ta</span> <span class="main">=</span> <span class="bound">d</span><span class="main">)</span>"</span></span>

    <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">d2</span><span class="main">≠</span><span class="free">TEE</span><span class="main">∧</span><span class="free">d1</span><span class="main">≠</span><span class="free">REE</span><span class="main">∧</span><span class="free">d2</span><span class="main">≠</span><span class="free">d1</span><span class="main">⟶</span><span class="free">readMem</span> <span class="main">(</span><span class="free">getMem</span> <span class="free">s</span> <span class="free">d1</span><span class="main">)</span> <span class="free">d2</span> <span class="main">=</span> None"</span></span>
    <span class="comment1">(*None stand for cant read, maybe change to ¬allowRead*)</span>
    


<span class="comment1">(*
T.TEE_FIRMWARE_DOWNGRADE 
An attacker backs up part or all of the TEE firmware and restores it later 
in order to use obsolete TEE functionality.
Assets threatened directly: TEE firmware (integrity). 
Assets threatened indirectly: All data and keys (confidentiality, authenticity, consistency).
*)</span>

<span class="keyword1"><span class="command">locale</span></span> T_TEE_FIRMWARE_DOWNGRADE <span class="main">=</span> TState <span class="main">+</span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">check_version</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'SoC</span><span class="main">⇒</span><span class="tfree">'firmware</span><span class="main">⇒</span>bool"</span></span><span class="comment1">(*check whether firmware is obsolete*)</span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">initialize1</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'sysconf</span><span class="main">⇒</span><span class="main">(</span><span class="tfree">'s</span> <span class="main">×</span> bool<span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">getfirmware</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'s</span><span class="main">⇒</span><span class="tfree">'firmware</span>"</span></span>
    <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">s0</span> <span class="main">=</span> fst<span class="main">(</span><span class="free">initialize1</span> <span class="free">sc</span><span class="main">)</span><span class="main">∧</span>snd<span class="main">(</span><span class="free">initialize1</span> <span class="free">sc</span><span class="main">)</span>
            <span class="main">⟶</span> <span class="free">check_version</span> <span class="main">(</span><span class="free">getSoc</span> <span class="free">s0</span><span class="main">)</span> <span class="main">(</span><span class="free">getfirmware</span> <span class="free">s0</span><span class="main">)</span>"</span></span>


<span class="comment1">(*
T.STORAGE_CORRUPTION
An attacker corrupts all or part of the non-volatile storage used by the TEE including the trusted storage, in 
an attempt to trigger unexpected behaviour from the storage security mechanisms. The ultimate goal of the 
attack is to disclose and/or modify TEE or TA data and/or code.
Assets threatened directly: TEE storage root of trust (confidentiality, integrity), TEE persistent data 
(confidentiality, consistency), TEE firmware (authenticity, integrity), TA data and keys (confidentiality, 
authenticity, consistency), TA instance time (integrity), TA code (authenticity, consistency).
Application Note:
The attack can rely, for instance, on the REE file system or the Flash driver.
*)</span>

<span class="keyword1"><span class="command">locale</span></span> T_STORAGE_CORRUPTION <span class="main">=</span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">corrupt_check</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'s</span><span class="main">⇒</span><span class="tfree">'storage_data</span><span class="main">⇒</span>bool"</span></span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">get_store_data</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'s</span><span class="main">⇒</span><span class="tfree">'storage_data</span>"</span></span>
    <span class="comment1">(*An attacker corrupts all or part of the non-volatile storage used by the TEE*)</span>
    <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">get_store_data</span> <span class="free">s</span><span class="main">≠</span><span class="free">sd</span> <span class="main">⟶</span><span class="main">¬</span><span class="free">corrupt_check</span> <span class="free">s</span> <span class="free">sd</span>"</span></span>


<span class="comment1">(*
T.ABUSE_DEBUG
An attacker manages to be granted access to TEE Debug features, allowing to obtain sensitive data or to 
compromise the TSF (bypass, deactivate or change security services).
Assets threatened directly: TEE initialisation code and data (integrity), TEE runtime data (confidentiality, 
integrity), RNG (confidentiality, integrity), TA code (authenticity, consistency).
Assets threatened indirectly: TA data and keys (confidentiality, authenticity, consistency) including instance 
time.
Application Note:
During the identification phase, the attacker may search for vulnerabilities, for instance by exploiting the 
JTAG interface to access the TEE debug mode.
*)</span>

<span class="keyword1"><span class="command">locale</span></span> T_ABUSE_DEBUG <span class="main">=</span> 
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">debug</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'s</span><span class="main">⇒</span><span class="tfree">'s</span>"</span></span>
    <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">check_drights</span><span class="main">::</span><span class="quoted"><span class="quoted">"<span class="tfree">'s</span><span class="main">⇒</span><span class="tfree">'d</span><span class="main">⇒</span>bool"</span></span>
    <span class="comment1">(*An attacker manages to be granted access to TEE Debug features*)</span>
    <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">"<span class="free">check_drights</span> <span class="free">s</span> <span class="free">d</span><span class="main">∧</span><span class="free">s'</span> <span class="main">=</span> <span class="free">debug</span> <span class="free">s</span><span class="main">⟶</span><span class="free">s'</span><span class="main">=</span><span class="free">s</span>"</span></span>


<span class="keyword2"><span class="keyword">end</span></span></pre>
<deepl-input-controller><template shadowrootmode="open"><link rel="stylesheet" href="chrome-extension://cofdbpoegempjloogbagkncekinflcnj/build/content.css"><div><div class="dl-input-translation-container svelte-ju4595"><div></div></div></div></template></deepl-input-controller></body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;full&quot;,&quot;isActive&quot;:true,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>